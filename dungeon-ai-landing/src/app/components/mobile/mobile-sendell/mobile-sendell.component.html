<!-- Mobile Sendell Chat v8.2 - Terminal Style -->
<div class="mobile-sendell" [class.minimized]="isMinimized">

  <!-- Terminal Header (simplified) -->
  <header class="terminal-header">
    <div class="terminal-title">
      <span class="title-prefix">//</span>
      <span class="title-text">SENDELL</span>
      @if (isTyping()) {
        <span class="typing-indicator">_</span>
      }
    </div>
    <div class="header-actions">
      <button class="action-btn" (click)="onMinimize()" aria-label="Minimizar">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="5" y1="12" x2="19" y2="12"/>
        </svg>
      </button>
      <button class="action-btn" (click)="onClose()" aria-label="Cerrar">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="18" y1="6" x2="6" y2="18"/>
          <line x1="6" y1="6" x2="18" y2="18"/>
        </svg>
      </button>
    </div>
  </header>

  <!-- Messages (hidden when minimized) -->
  @if (!isMinimized) {
    <div class="chat-body">
      <!-- Messages container -->
      <div class="messages-container" #messagesContainer>
        @for (message of messages(); track message.id) {
          <div
            class="message"
            [class.user]="message.sender === 'user'"
            [class.sendell]="message.sender === 'sendell'"
          >
            @if (message.sender === 'sendell') {
              <span class="message-prefix">&gt;</span>
            }
            <div class="message-content">
              <p class="message-text">{{ message.text }}</p>
            </div>
          </div>
        }

        <!-- Typing indicator -->
        @if (isTyping()) {
          <div class="message sendell typing">
            <span class="message-prefix">&gt;</span>
            <div class="message-content">
              <span class="cursor-blink">_</span>
            </div>
          </div>
        }
      </div>

      <!-- Quick actions -->
      @if (messages().length <= 1) {
        <div class="quick-actions">
          @for (action of quickActions; track action.label) {
            <button
              class="quick-btn"
              (click)="onQuickAction(action.query)"
            >
              {{ action.label }}
            </button>
          }
        </div>
      }
    </div>

    <!-- Input area -->
    <footer class="chat-input">
      <span class="input-prompt">&gt;</span>
      <input
        #inputField
        type="text"
        [(ngModel)]="inputText"
        (keydown)="onKeyDown($event)"
        placeholder="Escribe aquÃ­..."
        class="input-field"
        autocomplete="off"
      />
      <button
        class="send-btn"
        (click)="sendMessage()"
        [disabled]="!inputText.trim()"
        aria-label="Enviar"
      >
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <polyline points="9 18 15 12 9 6"/>
        </svg>
      </button>
    </footer>
  }
</div>
