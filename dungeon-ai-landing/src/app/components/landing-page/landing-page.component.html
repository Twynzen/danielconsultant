<!-- Viewport - Fixed window into the side-scroller world -->
<!-- v4.6.3: Added zoom binding for cinematic effect -->
<div class="dungeon-viewport"
     [class.zoomed]="isZoomed"
     [style.--zoom-scale]="zoomScale">

  <!-- ========== FIXED UI LAYER (doesn't scroll) ========== -->
  <div class="fixed-ui">
    <!-- Title - Fixed at top of screen -->
    <div class="fixed-title">
      <span class="main-title">CONSULTOR IA</span>
      <span class="subtitle">DANIEL CASTIBLANCO</span>
    </div>
  </div>

  <!-- ========== WORLD LAYER (scrolls horizontally) ========== -->
  <div class="dungeon-world"
       [style.width.px]="levelWidth"
       [style.transform]="cameraTransformValue">

    <!-- Background with circuits CSS approach -->
    <app-circuits-background></app-circuits-background>

    <!-- v4.7: Hieroglyphic Wall - Service inscriptions that illuminate on proximity -->
    <!-- v4.7.2: Added serviceClicked event to open modal on inscription click -->
    <app-hieroglyphic-wall
      [pillarIlluminations]="pillarIlluminations"
      (serviceClicked)="onServiceClicked($event)">
    </app-hieroglyphic-wall>

    <!-- Ground visual -->
    <div class="ground"
         [style.height.px]="groundHeight">
    </div>

    <!-- Pillar System - Interactive navigation (world coordinates) -->
    <!-- v4.7: Added illuminationsChanged for hieroglyphic wall -->
    <app-pillar-system
      (pillarActivated)="onPillarActivated($event)"
      (illuminationsChanged)="onIlluminationsChanged($event)">
    </app-pillar-system>

  </div>

  <!-- ========== SCREEN LAYER (Fixed to viewport) ========== -->

  <!-- Character - Fixed X (centered), Y moves with jump -->
  <app-flame-head-character></app-flame-head-character>

  <!-- v4.7: DEPRECATED - Hologram replaced by HieroglyphicWall -->
  <!-- <app-hologram-projection
    [pillarConfig]="activeHologramPillar"
    [pillarScreenX]="hologramScreenX"
    [pillarScreenY]="hologramScreenY"
    [isVisible]="isHologramActive"
    [isZoomed]="isZoomed"
    (closeHologram)="onCloseHologram()"
    (urlClicked)="onHologramUrlClick($event)">
  </app-hologram-projection> -->

  <!-- v4.7.2: Modal Service - Opens when clicking service inscriptions -->
  <!-- v4.7.2: Added serviceColor for dynamic theming -->
  <app-modal-service
    [serviceId]="selectedServiceId"
    [isOpen]="isModalOpen"
    [serviceColor]="selectedServiceColor"
    (closeModal)="onCloseModal()">
  </app-modal-service>

</div>
