<!-- Binary AI Character v5.2 - MATERIALIZACIÃ“N DIGITAL + PILLAR ENERGIZATION -->
<div class="binary-character"
     [class.moving]="isMoving"
     [class.jumping]="isJumping"
     [class.landing]="isLanding()"
     [class.assembling]="assemblyPhase() === 'assembling' || assemblyPhase() === 'scattered'"
     [class.crashing]="isCrashing()"
     [class.energizing]="isEnergizing()"
     [class.inside-pillar]="isInsidePillar()"
     [class.exiting-pillar]="assemblyPhase() === 'exiting_pillar'"
     [attr.data-emotion]="emotionClass()"
     [attr.data-facing]="facingRight ? 'right' : 'left'"
     [attr.data-assembly]="assemblyPhase()"
     [style.transform]="characterTransform">

  <!-- Glow backdrop -->
  <div class="glow"></div>

  <!-- Character container -->
  <div class="character-container">

    <!-- Body (head, torso, arms) -->
    <div class="grid body-grid">
      <div class="row" *ngFor="let row of bodyGrid; let ri = index">
        <!-- Eye wrapper for tracking -->
        <ng-container *ngFor="let digit of row; let ci = index">
          <!-- Eyes get special wrapper with transform (eye tracking + scatter) -->
          <span *ngIf="digit.type === 'eye'"
                class="eye-wrapper scatter-digit energy-particle"
                [style.transform]="getEyeTransform() + ' ' + getDigitTransform('body', ri, ci)">
            <span [class]="getDigitClasses(digit, 'body', ri, ci)"
                  [style.opacity]="getDigitOpacity('body', ri, ci, getBrightness(digit))">{{ getDisplayChar(digit, 'body', ri, ci) }}</span>
          </span>
          <!-- Non-eye digits render with scatter transform -->
          <span *ngIf="digit.type !== 'eye'"
                class="scatter-digit energy-particle"
                [class]="getDigitClasses(digit, 'body', ri, ci)"
                [style.opacity]="getDigitOpacity('body', ri, ci, getBrightness(digit))"
                [style.transform]="getDigitTransform('body', ri, ci)">{{ getDisplayChar(digit, 'body', ri, ci) }}</span>
        </ng-container>
      </div>
    </div>

    <!-- Arms (animated separately, overlaid on body) -->
    <div class="grid arms-grid">
      <div class="row" *ngFor="let row of armsGrid; let ri = index">
        <span *ngFor="let digit of row; let ci = index"
              class="scatter-digit energy-particle"
              [class]="getDigitClasses(digit, 'arms', ri, ci)"
              [style.opacity]="getDigitOpacity('arms', ri, ci, getBrightness(digit))"
              [style.transform]="getDigitTransform('arms', ri, ci)">{{ getDisplayChar(digit, 'arms', ri, ci) }}</span>
      </div>
    </div>

    <!-- Legs (animated separately) -->
    <div class="grid legs-grid">
      <div class="row" *ngFor="let row of legsGrid; let ri = index">
        <span *ngFor="let digit of row; let ci = index"
              class="scatter-digit energy-particle"
              [class]="getDigitClasses(digit, 'legs', ri, ci)"
              [style.opacity]="getDigitOpacity('legs', ri, ci, getBrightness(digit))"
              [style.transform]="getDigitTransform('legs', ri, ci)">{{ getDisplayChar(digit, 'legs', ri, ci) }}</span>
      </div>
    </div>

  </div>

  <!-- Inner glow -->
  <div class="glow-inner"></div>
</div>
